<!DOCTYPE html>
<html lang="<%= language || 'sk' %>">

<head>
    <%- include('partials/head') %>
        <style>
            .category-header {
                margin-top: 40px;
                padding-bottom: 20px;
                text-align: left;
                display: flex;
                flex-direction: column;
                align-items: flex-start;
            }

            .cat-title-row {
                display: flex;
                align-items: center;
                gap: 16px;
                margin-bottom: 16px;
            }

            .cat-icon-box {
                width: 48px;
                height: 48px;
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid var(--glass-border);
            }

            .cat-title {
                font-size: 2rem;
                font-weight: 700;
                margin: 0;
                color: var(--text-primary);
            }

            .cat-desc {
                font-size: 1.1rem;
                color: var(--text-secondary);
                max-width: 600px;
            }
        </style>
</head>

<body class="theme-dark">
    <!-- Background Ambient Effects -->
    <div class="ambient-bg">
        <div class="blob blob-purple"></div>
        <div class="blob blob-emerald"></div>
        <div class="blob blob-amber"></div>
        <div class="noise-overlay"></div>
    </div>

    <!-- Navigation -->
    <%- include('partials/header') %>

        <main class="main-content">
            <!-- Category Header (SSR) -->
            <header class="category-header animate-slide-up">
                <% /* Category Meta provided by server */ %>
                    <div class="cat-title-row">
                        <div id="cat-icon" class="cat-icon-box" style="
                        color: <%= categoryMeta.color %>; 
                        border-color: <%= categoryMeta.color %>; 
                        background: color-mix(in srgb, <%= categoryMeta.color %> 10%, transparent);
                    ">
                            <iconify-icon icon="<%= categoryMeta.icon %>"></iconify-icon>
                        </div>

                        <h1 id="cat-title" class="cat-title" style="
                        background: linear-gradient(to right, <%= categoryMeta.color %>, var(--text-primary)); 
                        -webkit-background-clip: text; 
                        background-clip: text; 
                        color: transparent;
                    ">
                            <%= categoryMeta.title %>
                        </h1>
                    </div>

                    <p id="cat-desc" class="cat-desc">
                        <%= categoryMeta.desc[language] || categoryMeta.desc.sk %>
                    </p>
            </header>

            <!-- Feed Divider -->
            <div class="feed-divider">
                <span class="line"></span>
                <span class="text">FEED</span>
                <span class="line"></span>
            </div>

            <!-- Posts Grid (SSR) -->
            <div id="posts-container" class="posts-grid">
                <% if (posts && posts.length> 0) { %>
                    <% posts.forEach(function(post) { %>
                        <%- include('partials/card', { post: post, categoryColors: categoryColors, language: language })
                            %>
                            <% }); %>
                                <% } else { %>
                                    <div class="loading-state" style="opacity:0.6">No posts found.</div>
                                    <% } %>
            </div>

            <!-- Site Footer -->
            <%- include('partials/footer') %>
        </main>

        <script>
            window.currentLang = "<%= language || 'sk' %>";
            window.initialPosts = true; // Signal for hydration (don't re-fetch CSR)
        </script>
</body>

</html>